---
title: "Defining Template"
description: "How to create your own template"
icon: "2"
---

### Method chaining

All template methods return the template instance, allowing for fluent API usage:

<CodeGroup dropdown>

```typescript
const template = Template()
  .fromUbuntuImage("22.04")
  .aptInstall(["curl"]) // necessary for waitForPort
  .setWorkdir('/app')
  .copy("package.json", "/app/package.json")
  .runCmd("npm install")
  .setStartCmd("npm start", waitForPort(3000));
```

```python
template = (
    Template()
    .from_ubuntu_image("22.04")
    .set_workdir("/app")
    .copy("package.json", "/app/package.json")
    .run_cmd("npm install")
    .set_start_cmd("npm start", wait_for_timeout(10_000)))
```

</CodeGroup>

### User and workdir

Set the working directory and user for the template:

<CodeGroup dropdown>

```typescript
// Set working directory
template.setWorkdir("/app");

// Set user (runs subsequent commands as this user)
template.setUser('node')
template.setUser("1000:1000"); // User ID and group ID
```

```python
# Set working directory
template.set_workdir("/app")

# Set user (runs subsequent commands as this user)
template.set_user("node")
template.set_user("1000:1000")  # User ID and group ID
```

</CodeGroup>

### Copying files

Copy files from your local filesystem to the template:

<CodeGroup dropdown>

```typescript
// Copy a single file
template.copy("package.json", "/app/package.json");

// Copy multiple files
template.copy([
  { src: "src/", dest: "/app/src/" },
  { src: "package.json", dest: "/app/package.json" },
]);

// Force upload (bypass cache)
template.copy("config.json", "/app/config.json", { forceUpload: true });

// Copy with user and mode options
template.copy("config.json", "/app/config.json", {
  user: "appuser",
  mode: 0o644,
});
```

```python
# Copy a single file
template.copy("package.json", "/app/package.json")

# Copy multiple files
template.copy([
    {"src": "src/", "dest": "/app/src/"},
    {"src": "package.json", "dest": "/app/package.json"},
])

# Force upload (bypass cache)
template.copy("config.json", "/app/config.json", force_upload=True)
```

</CodeGroup>

### File operations

Perform various file operations during template build:

<CodeGroup dropdown>

```typescript
// Remove files or directories
template.remove("/tmp/temp-file.txt");
template.remove("/old-directory", { recursive: true });
template.remove("/file.txt", { force: true });

// Rename files or directories
template.rename("/old-name.txt", "/new-name.txt");
template.rename("/old-dir", "/new-dir", { force: true });

// Create directories
template.makeDir("/app/logs");
template.makeDir("/app/data", { mode: 0o755 });

// Create symbolic links
template.makeSymlink("/app/data", "/app/logs/data");
```

```python
# Remove files or directories
template.remove("/tmp/old-file")
template.remove("/tmp/old-dir", recursive=True)
template.remove("/tmp/file", force=True)  # Force removal

# Rename files or directories
template.rename("/old/path", "/new/path")
template.rename("/old/path", "/new/path", force=True)  # Force rename

# Create directories
template.make_dir("/app/data")
template.make_dir("/app/data", mode=0o755)  # Set permissions

# Create symbolic links
template.make_symlink("/path/to/target", "/path/to/link")
```

</CodeGroup>

### Installing packages

Install packages using package managers:

<CodeGroup dropdown>

```typescript
// Install Python packages
template.pipInstall('requests pandas numpy')
template.pipInstall(['requests', 'pandas', 'numpy'])

// Install Node.js packages
template.npmInstall('express lodash')
template.npmInstall(['express', 'lodash'])

// Install system packages (automatically runs apt update)
template.aptInstall('curl wget git')
template.aptInstall(['curl', 'wget', 'git'])
```

```python
# Install Python packages
template.pip_install("requests pandas numpy")
template.pip_install(["requests", "pandas", "numpy"])

# Install Node.js packages
template.npm_install("express lodash")
template.npm_install(["express", "lodash"])

# Install system packages (Ubuntu/Debian)
template.apt_install("curl wget git")
template.apt_install(["curl", "wget", "git"])
```

</CodeGroup>

### Git operations

Clone Git repositories during template build (requires `git` to be installed):

<CodeGroup dropdown>

```typescript
// Clone a repository
template.gitClone('https://github.com/user/repo.git', '/app/repo')

// Clone a specific branch
template.gitClone('https://github.com/user/repo.git', '/app/repo', {
  branch: 'main',
})

// Clone with depth limit
template.gitClone('https://github.com/user/repo.git', '/app/repo', {
  depth: 1,
})
```

```python
# Basic clone
template.git_clone("https://github.com/user/repo.git", "/app/repo")

# Clone specific branch
template.git_clone("https://github.com/user/repo.git", "/app/repo", branch="main")

# Shallow clone with depth limit
template.git_clone("https://github.com/user/repo.git", "/app/repo", depth=1)

```

</CodeGroup>

### Environment variables

Set environment variables in the template:

<CodeGroup dropdown>

```typescript
template.setEnvs({
  NODE_ENV: 'production',
  API_KEY: 'your-api-key',
  DEBUG: 'true',
})
```

```python
template.set_envs({
    "NODE_ENV": "production",
    "API_KEY": "your-api-key",
    "DEBUG": "true",
})
```

</CodeGroup>

### Invalidating caches

Force rebuild from the next instruction:

<CodeGroup dropdown>

```typescript
template.skipCache()
```

```python
template.skip_cache()
```

</CodeGroup>

This will invalidate the cache for all subsequent instructions in the template.

### Running commands

Execute shell commands during template build:

<CodeGroup dropdown>

```typescript
// Run a single command
template.runCmd('apt-get update && apt-get install -y curl')

// Run multiple commands
template.runCmd(['apt-get update', 'apt-get install -y curl', 'curl --version'])

// Run commands as a specific user
template.runCmd('npm install', { user: 'node' })
```

```python
# Run a single command
template.run_cmd("apt-get update && apt-get install -y curl")

# Run multiple commands
template.run_cmd(["apt-get update", "apt-get install -y curl", "curl --version"])

# Run command as specific user
template.run_cmd("npm install", user="node")
```

</CodeGroup>
